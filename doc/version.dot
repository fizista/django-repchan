digraph versioning {

	main;
	main_changes;
	rev;
	rev_changes;
	
	{ rank = same; "main"; "main_changes"; "rev"; "rev_changes"; }
	
	set_as_main_version [shape=polygon,sides=4,skew=.4];
	create_revision [shape=polygon,sides=4,skew=.4];
	commit [shape=polygon,sides=4,skew=.4];
	save [shape=polygon,sides=4,skew=.4];
	_save [shape=polygon,sides=4,skew=.4];
	_copy_to_ [shape=polygon,sides=4,skew=.4];
	
	{ rank = same; "set_as_main_version"; "create_revision";commit;save; }
	{ rank = same; "_save"; "_copy_to_"; }
	
	e [shape=polygon,sides=4,distortion=.4,label="Exception"];



	set_as_main_version -> main -> e;
	set_as_main_version -> main_changes -> e;
	set_as_main_version -> rev -> _copy_to_ -> main;
	set_as_main_version -> rev_changes -> create_revision -> 
		commit ->  _copy_to_ -> main;

	create_revision ->  main -> _copy_to_ -> rev;
	create_revision ->  main_changes -> _copy_to_ -> rev;
	create_revision ->  rev -> _copy_to_ -> rev;
	create_revision ->  rev_changes -> _copy_to_ -> rev;

	commit -> main -> e;
	commit -> main_changes -> e; 
	commit -> rev -> _save;
	commit -> rev_changes -> e;
	 

}
